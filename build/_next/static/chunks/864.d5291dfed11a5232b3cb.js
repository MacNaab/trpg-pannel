(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[864],{1034:function(e,o,n){"use strict";n.r(o),n.d(o,{default:function(){return X}});var t=n(5893),r=n(9227),i=n(7294),a=n(9941),s=n(7409),l=(n(4593),n(795)),c=n(4968),d=n(6584),u=n(6265),m=n(4860),p=n(155),h=n(8135),g=n(5003),f=n(6729),x=n(6618),j=n(5372),b=n(8104),v=n(9887),w=n(17),y=n(5243),k=n.n(y),S=[{id:"Gold",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-gold.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Violet",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-violet.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Rouge",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Vert",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Orange",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-orange.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Jaune",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-yellow.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Gris",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Noir",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-black.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})},{id:"Bleu",marker:new(k().Icon)({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]})}],O=n(1608),I=["icon","img","titre","description"];function P(e,o){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),n.push.apply(n,t)}return n}function N(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?P(Object(n),!0).forEach((function(o){(0,u.Z)(e,o,n[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}))}return e}var z=n(8379),A=S.map((function(e){return(0,t.jsx)("option",{value:e.id,children:e.id},z())}));function Z(e){var o=e.isAdd,n=e.setAdd,a=e.NewPosition,s=(0,m.q)(),l=s.isOpen,c=s.onOpen,d=s.onClose,y=i.useRef(),k=i.useState({icon:"",img:"",titre:"",description:""}),P=(0,r.Z)(k,2),z=P[0],Z=P[1],C=i.useState(""),D=(0,r.Z)(C,2),M=D[0],U=D[1],E=function(e){var o=e.target,n=o.name,t=o.value;Z(N(N({},z),{},(0,u.Z)({},n,t)))},J=i.useState(""),L=(0,r.Z)(J,2),F=L[0],V=L[1];return i.useEffect((function(){var e=S.find((function(e){return e.id===z.icon}));if(e){var o,n,t=null===(o=e.marker)||void 0===o||null===(n=o.options)||void 0===n?void 0:n.iconUrl;t&&t!==F&&V(t)}}),[z.icon]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.z,{ref:y,colorScheme:"teal",onClick:c,children:"Menu"}),(0,t.jsxs)(h.dy,{isOpen:l,placement:"right",onClose:d,finalFocusRef:y,children:[(0,t.jsx)(g.ZA,{}),(0,t.jsxs)(h.sc,{children:[(0,t.jsx)(g.ol,{}),(0,t.jsx)(g.xB,{children:"Menu Admin"}),(0,t.jsxs)(g.fe,{children:[(0,t.jsxs)(f.NI,{display:"flex",alignItems:"center",children:[(0,t.jsx)(x.l,{htmlFor:"email-alerts",mb:"0",title:"Double clic pour ajouter un marker",children:"Mode Ajout Marker"}),(0,t.jsx)(j.r,{id:"email-alerts",size:"lg",isChecked:o,onChange:function(){n(!o)}})]}),(0,t.jsx)("hr",{className:"mt-4"}),(0,t.jsxs)("div",{className:"grid justify-items-center gap-2 mt-10",children:[(0,t.jsxs)(b.Ph,{defaultValue:"Layer",onChange:function(e){U(e.target.value)},children:[(0,t.jsx)("option",{value:"Layer",children:"Layer"}),(0,t.jsx)("option",{value:"Commun",children:"Commun"}),(0,t.jsx)("option",{value:"PJ 1",children:"PJ 1"})]}),(0,t.jsxs)("span",{children:["Position: ",null!==a?(0,t.jsxs)("span",{children:[" ",a[0].toFixed(2)," , ",a[1].toFixed(2)," "]}):null," "]}),(0,t.jsx)("img",{alt:"",className:"rounded-xl w-14 h-14",src:z.img}),(0,t.jsx)(v.I,{placeholder:"Image (url)",name:"img",onChange:E}),(0,t.jsx)("img",{alt:"",className:"rounded-xl w-14 h-14",src:F}),(0,t.jsxs)(b.Ph,{defaultValue:"Icone",name:"icon",onChange:E,children:[(0,t.jsx)("option",{disabled:!0,value:"Icone",children:"Icone"}),A]}),(0,t.jsx)(v.I,{placeholder:"Titre",value:z.titre,name:"titre",onChange:E}),(0,t.jsx)(w.g,{placeholder:"Description ...",value:z.description,name:"description",onChange:E})]})]}),(0,t.jsxs)(g.mz,{children:[(0,t.jsx)(p.z,{variant:"outline",mr:3,onClick:d,children:"Annuler"}),(0,t.jsx)(p.z,{colorScheme:"blue",onClick:function(){!function(e,o,n,t){var r="";if(!e&&(r+="MapID "),!o&&(r+="Layer "),I.forEach((function(e){!n[e]&&(r+=e+" ")})),t?n.position=t:r+="position ",r)alert("Erreur: vous devez remplir tous les champs ("+r+")");else{var i={id:e,body:o,data:n};fetch(O.Jx+"map/add.php",{method:"POST",body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){console.log(e)}),(function(e){console.log(e),alert("Une erreur c'est produite durant l'envoie des donn\xe9es, plus d'information dans la console.")}))}}(localStorage.getItem("MapID"),M,z,a)},children:"Valider"})]})]})]})]})}var C=n(6967),D={bottomleft:"leaflet-bottom leaflet-left",bottomright:"leaflet-bottom leaflet-right",topleft:"leaflet-top leaflet-left",topright:"leaflet-top leaflet-right"};function M(e){var o=e.position,n=e.setAdd,r=e.isAdd,i=e.NewPosition,a=e.setPosition,s=o&&D[o]||D.topright;return(0,t.jsx)("div",{className:s,children:(0,t.jsx)("div",{className:"leaflet-control leaflet-bar",children:(0,t.jsx)(C.x,{children:(0,t.jsx)(Z,{setAdd:n,isAdd:r,NewPosition:i,setPosition:a})})})})}var U=n(1372),E=n(8543),J=n(8193),L=n(1167),F=n.n(L);n(3773);function V(e,o){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),n.push.apply(n,t)}return n}function G(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?V(Object(n),!0).forEach((function(o){(0,u.Z)(e,o,n[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))}))}return e}var T,_=n(8379),R=S.map((function(e){return(0,t.jsx)("option",{value:e.id,children:e.id},_())}));function B(e){var o=i.useState(!1),n=(0,r.Z)(o,2),a=n[0],s=n[1],l=i.useState({position:e.position,icon:e.icon,img:e.img,titre:e.titre,description:e.description}),c=(0,r.Z)(l,2),d=c[0],m=c[1],p=i.useState({position:e.position,icon:e.icon,img:e.img,titre:e.titre,description:e.description}),h=(0,r.Z)(p,2),g=h[0],f=h[1],x=function(e){if(e.target){var o=e.target,n=o.value,t=o.name;m(G(G({},d),{},(0,u.Z)({},t,n)))}};return(0,t.jsx)("div",{className:"w-full mx-auto",children:(0,t.jsxs)("div",{className:"rounded-xl bg-blueGray-50",children:["admin"===e.userID?(0,t.jsx)("button",{type:"button",onClick:function(){s(!a)},className:"float-right rounded-full hover:bg-gray-100 hover:border-gray-500 hover:p-1 ",children:(0,t.jsx)(J.$iz,{className:"m-auto"})}):null,a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{className:"object-cover object-center w-full lg:h-48 md:h-36 rounded-xl",src:d.img,alt:"erreur"}),(0,t.jsx)("input",{onChange:x,value:d.img,name:"img",className:"w-full mb-4 px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg  focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Image (URL)"})]}):(0,t.jsx)("img",{className:"object-cover object-center w-full mb-4 lg:h-48 md:h-36 rounded-xl",src:g.img,alt:"blog"}),(0,t.jsx)("h1",{className:"mx-auto mb-8 text-2xl font-semibold leading-none tracking-tighter text-black title-font",children:a?(0,t.jsx)("input",{onChange:x,value:d.titre,name:"titre",className:"w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg  focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Titre"}):g.titre}),(0,t.jsx)("div",{className:"mx-auto text-justify text-base font-medium leading-relaxed text-blueGray-700 ",children:a?(0,t.jsx)(F(),{theme:"snow",onChange:function(e){m(G(G({},d),{},{description:e}))},value:d.description,placeholder:"Description"}):(0,t.jsx)("p",{dangerouslySetInnerHTML:{__html:g.description}})}),a?(0,t.jsx)("div",{className:"m-2",children:(0,t.jsxs)("select",{defaultValue:d.icon,name:"icon",onChange:x,className:"p-1 flex m-auto",children:[(0,t.jsx)("option",{disabled:!0,children:"Couleur du Marker"}),R]})}):null,(0,t.jsx)("p",{className:"mx-auto text-justify text-base font-medium leading-relaxed text-blueGray-700 ",children:a?(0,t.jsx)("button",{type:"button",className:"w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",onClick:function(){f(d),function(e,o,n){var t={id:e,body:o,data:n};fetch(O.Jx+"map/edit.php",{method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){console.log(e)}),(function(e){console.log(e),alert("Une erreur c'est produite durant l'envoie des donn\xe9es, plus d'information dans la console.")}))}(localStorage.getItem("MapID"),e.bodyCard,d),s(!1)},children:"Valider"}):null})]})})}var W=null===(T=S[0])||void 0===T?void 0:T.marker;function q(e){var o=S.find((function(o){return o.id===e.icon}));return(0,t.jsx)(s.J,{position:e.position,icon:o?o.marker:W,children:(0,t.jsx)(E.G,{children:(0,t.jsx)(B,{userID:e.userID,bodyCard:e.bodyCard,img:e.img,titre:e.titre,description:e.description,position:e.position,icon:e.icon})})})}var H=n(8379);function $(e){var o=e.userID,n=e.mapData,r=Object.keys(n.Player),i=n.Commun.map((function(e){return(0,t.jsx)(q,{body:"Commun",position:e.position,icon:e.icon,img:e.img,titre:e.titre,description:e.description},H())}));if("admin"===o){var a=r.map((function(e){return(0,t.jsx)(c.et.Overlay,{name:e,checked:!0,children:(0,t.jsx)(U.e,{children:n.Player[e].map((function(n){return(0,t.jsx)(q,{bodyCard:e,userID:o,position:n.position,icon:n.icon,img:n.img,titre:n.titre,description:n.description},H())}))})},H())}));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.et.Overlay,{name:"Layer Commun",checked:!0,children:(0,t.jsx)(U.e,{children:i})}),a]})}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.et.Overlay,{name:"Layer Commun",checked:!0,children:(0,t.jsx)(U.e,{children:i})}),(0,t.jsx)(c.et.Overlay,{name:o,checked:!0,children:(0,t.jsx)(U.e,{children:r.includes(o)?n.Player[o].map((function(e){return(0,t.jsx)(q,{bodyCard:o,position:e.position,icon:e.icon,img:e.img,titre:e.titre,description:e.description},H())})):null})})]})}function K(e){var o=e.MapID,n=e.setAdd,r=e.isAdd,i=e.ElPosition,a=e.setPosition,s=e.LocationMarker,u=e.mapData,m=e.userID;return(0,t.jsxs)(l.h,{center:[0,0],zoom:o.zoom,minZoom:o.minZoom,maxZoom:o.maxZoom,scrollWheelZoom:!1,style:{height:"80vh",width:"100%"},children:[(0,t.jsxs)(c.et,{position:"bottomleft",children:[(0,t.jsx)(c.et.BaseLayer,{checked:!0,name:"OpenStreetMap.Mapnik",children:(0,t.jsx)(d.I,{url:"https://macnaab.github.io/Random-Tables/WM/"+o.id+"/map/{z}/{x}/{y}.png"})}),(0,t.jsx)($,{userID:m,mapData:u})]}),(0,t.jsx)(M,{position:"topright",setAdd:n,isAdd:r,NewPosition:i,setPosition:a}),(0,t.jsx)(s,{})]})}var Q=n(3780),X=function(){var e=i.useState(!1),o=(0,r.Z)(e,2),n=o[0],l=o[1],c=i.useState(null),d=(0,r.Z)(c,2),u=d[0],m=d[1],p=i.useState({id:null,zoom:3,minZoom:2,maxZoom:5}),h=(0,r.Z)(p,2),g=h[0],f=h[1],x=i.useState(!1),j=(0,r.Z)(x,2),b=j[0],v=j[1],w=i.useState(null),y=(0,r.Z)(w,2),k=y[0],S=y[1],I=i.useState(null),P=(0,r.Z)(I,2),N=P[0],z=P[1];return i.useEffect((function(){var e=localStorage.getItem("MapID");e?(f({id:e,zoom:Number(localStorage.getItem("MapZoom")),minZoom:Number(localStorage.getItem("MapMinZ")),maxZoom:Number(localStorage.getItem("MapMaxZ"))}),console.log("Param\xe8tres de la carte:",{id:e,zoom:Number(localStorage.getItem("MapZoom")),minZoom:Number(localStorage.getItem("MapMinZ")),maxZoom:Number(localStorage.getItem("MapMaxZ"))}),fetch(O.Jx+"map/"+e+".json").then((function(e){return e.json()})).then((function(e){S(e),v(!0)}),(function(e){console.log(e),alert("Une erreur est survenue lors du chargement des donn\xe9es, consulter la console pour plus d'informations.")}))):alert("Erreur: MapID est null");var o=localStorage.getItem("PJ");o&&z(o)}),[]),(0,t.jsx)(t.Fragment,{children:b?(0,t.jsx)(K,{MapID:g,setAdd:l,isAdd:n,ElPosition:u,setPosition:m,LocationMarker:function(){return n&&(0,a.zV)({dblclick:function(e){m([e.latlng.lat,e.latlng.lng])}}),null===u?null:(0,t.jsx)(s.J,{position:u})},userID:N,mapData:k}):(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"m-auto w-0",children:(0,t.jsx)(Q.Fold,{size:50,color:"purple"})}),(0,t.jsx)("div",{children:"Chargement ..."})]})})}}}]);